const _0x3bd14e=_0x9ba4;(function(_0x308786,_0x5c87c9){const _0x51a9a1=_0x9ba4,_0x572dad=_0x308786();while(!![]){try{const _0x498b96=parseInt(_0x51a9a1(0x175))/0x1+parseInt(_0x51a9a1(0x167))/0x2+parseInt(_0x51a9a1(0x179))/0x3+parseInt(_0x51a9a1(0x17b))/0x4+-parseInt(_0x51a9a1(0x180))/0x5*(parseInt(_0x51a9a1(0x173))/0x6)+parseInt(_0x51a9a1(0x18a))/0x7+-parseInt(_0x51a9a1(0x16c))/0x8;if(_0x498b96===_0x5c87c9)break;else _0x572dad['push'](_0x572dad['shift']());}catch(_0x11aa52){_0x572dad['push'](_0x572dad['shift']());}}}(_0x1a7f,0x52229));const asyncHandler=require('express-async-handler'),ApiError=require(_0x3bd14e(0x190)),ProductModel=require(_0x3bd14e(0x172)),path=require('path'),excelJS=require(_0x3bd14e(0x18d));function _0x9ba4(_0x5221cd,_0xd0d1de){const _0x1a7f44=_0x1a7f();return _0x9ba4=function(_0x9ba43,_0x55eeb0){_0x9ba43=_0x9ba43-0x164;let _0x3da1fc=_0x1a7f44[_0x9ba43];return _0x3da1fc;},_0x9ba4(_0x5221cd,_0xd0d1de);}module['exports']={'addProduct':asyncHandler(async(_0x6080c8,_0x4edafc)=>{const _0x5ce17b=_0x3bd14e,_0x2522ae=_0x6080c8[_0x5ce17b(0x16b)][_0x5ce17b(0x188)],_0x2a8330=_0x6080c8[_0x5ce17b(0x16b)][_0x5ce17b(0x166)],_0x58f6d5=_0x6080c8[_0x5ce17b(0x16b)][_0x5ce17b(0x189)],_0x1188fe=_0x6080c8['body'][_0x5ce17b(0x182)],_0x2db2ff=await ProductModel[_0x5ce17b(0x16a)]({'proCode':_0x2522ae,'proName':_0x2a8330,'proPackaging':_0x58f6d5,'consumerPrice':_0x1188fe});_0x4edafc[_0x5ce17b(0x17d)](0xc9)[_0x5ce17b(0x18f)]({'data':_0x2db2ff});}),'getProducts':asyncHandler(async(_0x16cf64,_0x1c0af9)=>{const _0x324dd8=_0x3bd14e,_0x10ee08=_0x16cf64[_0x324dd8(0x181)][_0x324dd8(0x168)]*0x1||0x1,_0x4d85e1=_0x16cf64[_0x324dd8(0x181)][_0x324dd8(0x17c)]*0x1||0x14,_0x5e257b=(_0x10ee08-0x1)*_0x4d85e1,_0x300f77=await ProductModel[_0x324dd8(0x185)]({});_0x1c0af9['status'](0xc8)[_0x324dd8(0x18f)]({'results':_0x300f77[_0x324dd8(0x183)],'page':_0x10ee08,'data':_0x300f77[_0x324dd8(0x164)](_0x5e257b,_0x4d85e1*_0x10ee08)});}),'getProduct':asyncHandler(async(_0x2cbb7d,_0x219b7c,_0x48d451)=>{const _0xd8883e=_0x3bd14e,{id:_0x57a005}=_0x2cbb7d[_0xd8883e(0x174)],_0x356b04=await ProductModel[_0xd8883e(0x186)](_0x57a005);!_0x356b04?_0x48d451(new ApiError(_0xd8883e(0x17e)+_0x57a005,0x194)):_0x219b7c['status'](0xc8)['json']({'data':_0x356b04});}),'updateProduct':asyncHandler(async(_0x527f80,_0x40e134,_0x3aed86)=>{const _0x1c1938=_0x3bd14e,{id:_0x56c273}=_0x527f80[_0x1c1938(0x174)],_0x24930b=_0x527f80['body']['proName'],_0x92aa01=_0x527f80[_0x1c1938(0x16b)][_0x1c1938(0x189)],_0x2c8559=_0x527f80['body']['consumerPrice'],_0x380ecf=await ProductModel[_0x1c1938(0x18b)]({'_id':_0x56c273},{'proName':_0x24930b,'proPackaging':_0x92aa01,'consumerPrice':_0x2c8559},{'new':!![]});!_0x380ecf?_0x3aed86(new ApiError(_0x1c1938(0x17e)+_0x56c273,0x194)):_0x40e134[_0x1c1938(0x17d)](0xc8)[_0x1c1938(0x18f)]({'data':_0x380ecf});}),'deleteProduct':asyncHandler(async(_0x1a6b94,_0x7e768a,_0x2371e9)=>{const _0x4aed0d=_0x3bd14e,{id:_0x4aa5b0}=_0x1a6b94[_0x4aed0d(0x174)],_0x8dc05b=await ProductModel[_0x4aed0d(0x171)]({'_id':_0x4aa5b0});!_0x8dc05b?_0x2371e9(new ApiError('لا\x20يوجد\x20صنف\x20بهذا\x20الرقم\x20'+_0x4aa5b0,0x194)):_0x7e768a[_0x4aed0d(0x17d)](0xcc)['send']();}),'getReport':asyncHandler(async(_0x3e3dc0,_0x47d769,_0x334451)=>{const _0x1b4ae6=_0x3bd14e,_0x48404a=new excelJS[(_0x1b4ae6(0x18e))](),_0x47cab4=_0x48404a['addWorksheet'](_0x1b4ae6(0x176)),_0x4ce3c0=path[_0x1b4ae6(0x170)]('./الاصناف');_0x47cab4[_0x1b4ae6(0x177)]=[{'header':_0x1b4ae6(0x165),'key':_0x1b4ae6(0x188),'width':0xc},{'header':_0x1b4ae6(0x17f),'key':_0x1b4ae6(0x166),'width':0x32},{'header':'العبوة','key':_0x1b4ae6(0x189),'width':0xa},{'header':_0x1b4ae6(0x16e),'key':_0x1b4ae6(0x182),'width':0x1e}];var _0x4f1d4b=await ProductModel[_0x1b4ae6(0x185)]({});_0x4f1d4b[_0x1b4ae6(0x16d)](_0x4737a8=>{_0x47cab4['addRow'](_0x4737a8);}),_0x47cab4['getRow'](0x1)[_0x1b4ae6(0x178)](_0x34d4c3=>{const _0x325c98=_0x1b4ae6;_0x34d4c3[_0x325c98(0x16f)]={'bold':!![]};});try{const _0x2b6d47=await _0x48404a['xlsx']['writeFile'](_0x4ce3c0+_0x1b4ae6(0x184))['then'](()=>{const _0x275190=_0x1b4ae6;_0x47d769[_0x275190(0x18c)]({'status':_0x275190(0x169),'message':'تم\x20تجهيز\x20البيان\x20بنجاح','path':_0x4ce3c0+_0x275190(0x184)});});}catch(_0x4e08e2){_0x47d769[_0x1b4ae6(0x18c)]({'status':_0x1b4ae6(0x187),'message':_0x1b4ae6(0x17a)});}})};function _0x1a7f(){const _0x423964=['query','consumerPrice','length','/products.xlsx','find','findById','error','proCode','proPackaging','569149fRpbeH','findByIdAndUpdate','send','exceljs','Workbook','json','../utils/apiError','slice','كود\x20الصنف','proName','1181386tJklPn','page','success','create','body','5968200OSgorY','forEach','سعر\x20المستهلك','font','resolve','findByIdAndDelete','../models/product-model','6mGKUxO','params','473892dwwLID','بيان\x20الاصناف','columns','eachCell','366522LGfLbm','Something\x20went\x20wrong','543092QHvPnd','limit','status','لا\x20يوجد\x20صنف\x20بهذا\x20الرقم\x20','اسم\x20الصنف','1606945lAFUmy'];_0x1a7f=function(){return _0x423964;};return _0x1a7f();}